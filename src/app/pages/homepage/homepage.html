<form [formGroup]="trustForm" (ngSubmit)="onSubmit()" enctype="multipart/form-data"
      class="p-5 m-4 shadow-lg rounded-4 bg-light border border-2 border-danger-subtle">

  <h2 class="mb-4 text-danger border-bottom pb-2">
    ðŸ‡­ðŸ‡° Application for <span class="fw-bold">Hong Kong Foreign Trust</span>
  </h2>

  <!-- General Information -->
  <div class="mb-4">
    <div class="row g-4">
      <div class="col-md-6">
        <label class="form-label fw-semibold">Full Names and Surname *</label>
        <input formControlName="fullName" type="text" class="form-control form-control-lg border-secondary-subtle"
               placeholder="Full name" />
      </div>
      <div class="col-md-6">
        <label class="form-label fw-semibold">Passport or ID Number *</label>
        <input formControlName="idNumber" type="text" class="form-control form-control-lg border-secondary-subtle"
               placeholder="Document number" />
      </div>
    </div>
  </div>

  <!-- Contact Details -->
  <div class="mb-4">
    <div class="row g-4">
      <div class="col-md-6">
        <label class="form-label fw-semibold">Email *</label>
        <input formControlName="email" type="email" class="form-control form-control-lg border-secondary-subtle"
               placeholder="you@example.com" />
      </div>
      <div class="col-md-6">
        <label class="form-label fw-semibold">Phone Number *</label>
        <input formControlName="phoneNumber" type="text" class="form-control form-control-lg border-secondary-subtle"
               placeholder="+27..." />
      </div>
    </div>
  </div>

  <!-- Trust Details -->
  <div class="card border-danger-subtle shadow mb-4">
    <div class="card-header bg-danger text-white fs-5">
      ðŸ§¾ Trust Structure & Details
    </div>
    <div class="card-body">

      <!-- Trust Email -->
      <div class="mb-4">
        <label class="form-label">Trust Email (Optional)</label>
        <div class="d-flex align-items-center gap-3">
          <input formControlName="trustEmail" type="email" class="form-control" placeholder="trust@example.com"
                 [readonly]="useUserEmailForTrustEmail" style="max-width: 300px;" />
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="useUserEmailCheckbox"
                   [checked]="useUserEmailForTrustEmail"
                   (change)="toggleUseUserEmailForTrustEmail($event)" />
            <label class="form-check-label" for="useUserEmailCheckbox">
              Use my email
            </label>
          </div>
        </div>
      </div>

      <!-- Trust Name -->
      <div class="mb-4">
        <label class="form-label">Name of Trust *</label>
        <div class="d-flex align-items-center gap-3">
          <input formControlName="trustName" type="text" class="form-control" style="max-width: 300px;" />
          <div *ngIf="trustForm.get('trustName')?.value" class="text-muted">
            <em>The </em><span class="fw-normal">{{ trustForm.get('trustName')?.value }}</span><em> Hong Kong Foreign Trust</em>
          </div>
        </div>
      </div>

      <!-- Establishment Date -->
      <div class="mb-4">
        <label class="form-label">Date of Establishment *</label>
        <div class="d-flex align-items-center gap-3">
          <input formControlName="establishmentDate" type="date" class="form-control"
                 [min]="minDate" style="max-width: 300px;" />
          <div *ngIf="trustForm.get('establishmentDate')?.value" class="text-muted">
            <em>{{ trustForm.get('establishmentDate')?.value | date: 'd MMMM yyyy' }}</em>
          </div>
        </div>
      </div>

      <!-- Settlor & Trustee 1 -->
      <div class="mb-4">
        <label class="form-label fw-semibold">Settlor & Trustee 1</label>
        <div class="card border shadow bg-light-subtle p-3">
          <div class="row">
            <!-- Settlor -->
            <div class="col-md-6 mb-3">
              <h6 class="text-danger">Settlor</h6>
              <label>Full Name *</label>
              <input type="text" [value]="trustForm.get('fullName')?.value" class="form-control" readonly />
              <label>ID / Passport No *</label>
              <input type="text" [value]="trustForm.get('idNumber')?.value" class="form-control mb-2" readonly />
              <label>Upload Document *</label>
              <input type="file" class="form-control" (change)="onFileUpload('settlor', $event)" />
            </div>

            <!-- Trustee 1 -->
            <div class="col-md-6">
              <h6 class="text-danger">Trustee 1</h6>
              <div [formGroup]="firstTrustee">
                <label>Full Name *</label>
                <input type="text" formControlName="name" class="form-control" readonly />
                <label>ID / Passport No *</label>
                <input type="text" formControlName="id" class="form-control mb-2" readonly />
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Trustee 2 and Additional -->
      <div class="mb-4">
        <label class="form-label">Trustee 2 and Additional Trustees</label>
        <div class="row g-3">

          <!-- Trustee 2 -->
          <div class="col-md-6" [formGroup]="secondTrustee">
            <div class="card shadow bg-light-subtle p-3 h-100">
              <label class="form-label">Trustee 2</label>
              <input type="text" formControlName="name" class="form-control mb-2" placeholder="Full name" />
              <input type="text" formControlName="id" class="form-control mb-2" placeholder="ID/Passport" />
              <label>Upload Document *</label>
              <input type="file" class="form-control" (change)="onFileUpload('trustee2', $event)" />
            </div>
          </div>

          <!-- Dynamic Trustees -->
          <ng-container *ngFor="let trustee of trustees.controls; let i = index">
            <div *ngIf="i > 1" class="col-md-6" [formGroupName]="i">
              <div class="card shadow bg-light-subtle p-3 h-100">
                <label class="form-label">Trustee {{ i + 1 }} (Optional)</label>
                <input type="text" formControlName="name" class="form-control mb-2" />
                <input type="text" formControlName="id" class="form-control mb-2" />
                <label>Upload Document</label>
                <input type="file" class="form-control" (change)="onFileUpload('trustee' + i, $event)" />
              </div>
            </div>
          </ng-container>
        </div>

        <div class="mt-3">
          <button type="button" (click)="addTrustee()" class="btn btn-outline-danger btn-sm">
            âž• Add Another Trustee
          </button>
        </div>
      </div>

      <!-- Beneficiaries -->
      <div class="mb-4">
        <label class="form-label fw-semibold">List of Beneficiaries</label>
        <textarea formControlName="beneficiaries" class="form-control" rows="4"
                  placeholder="e.g. John Lee - 9001011234567"></textarea>
      </div>
    </div>
  </div>

  <!-- Submit -->
  <div class="d-grid">
    <button type="submit" class="btn btn-danger btn-lg" [disabled]="trustForm.invalid">
      ðŸ“¤ Submit Trust Application
    </button>
  </div>
</form>
